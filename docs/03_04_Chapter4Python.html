<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Microeconometrics: Methods and Applications - 14&nbsp; Chapter 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_references.html" rel="next">
<link href="./03_03_Chapter3Python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Chapter 4</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Microeconometrics: Methods and Applications</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/damiancclarke" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Microeconometrics--Methods-and-Applications.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Microeconometrics--Methods-and-Applications.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_01_About.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">About this book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_02_Download.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">How to download the required data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01_00_FollowingR.html" class="sidebar-item-text sidebar-link">Following Along with R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_01_IntroductionR.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An Introduction to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_02_Chapter2R.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_03_Chapter3R.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_04_Chapter4R.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02_00_FollowingStata.html" class="sidebar-item-text sidebar-link">Following Along with Stata</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_01_IntroductionStata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An Introduction to Stata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_02_Chapter2Stata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_03_Chapter3Stata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_04_Chapter4Stata.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03_00_FollowingPython.html" class="sidebar-item-text sidebar-link">Following Along with Python</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_01_IntroductionPython.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An Introduction to Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_02_Chapter2Python.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_03_Chapter3Python.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_04_Chapter4Python.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_references.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#code-call-out-4.1" id="toc-code-call-out-4.1" class="nav-link active" data-scroll-target="#code-call-out-4.1">Code Call Out 4.1</a>
  <ul class="collapse">
  <li><a href="#the-two-way-fixed-effect-estimator" id="toc-the-two-way-fixed-effect-estimator" class="nav-link" data-scroll-target="#the-two-way-fixed-effect-estimator">The Two-way Fixed Effect Estimator</a></li>
  <li><a href="#goodmanbacon2018-decomposition" id="toc-goodmanbacon2018-decomposition" class="nav-link" data-scroll-target="#goodmanbacon2018-decomposition"><span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (2021)</span> Decomposition</a></li>
  <li><a href="#dechaisemartindhaultfoeuille2019s-procedure" id="toc-dechaisemartindhaultfoeuille2019s-procedure" class="nav-link" data-scroll-target="#dechaisemartindhaultfoeuille2019s-procedure"><span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (2020)</span>’s Procedure</a></li>
  </ul></li>
  <li><a href="#synthetic-control-exercise" id="toc-synthetic-control-exercise" class="nav-link" data-scroll-target="#synthetic-control-exercise">Synthetic Control Exercise</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Chapter 4</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="code-call-out-4.1" class="level2">
<h2 class="anchored" data-anchor-id="code-call-out-4.1">Code Call Out 4.1</h2>
<p><strong>Two-Way Fixed Effects Estimators and Heterogeneous Treatment Effects</strong> To understand the potential issues related to heterogeneous treatment effects over time and two-way fixed effect estimators, we will examine a pair of numerical examples. In particular, we will focus on the composition of the two way FE estimator <span class="math inline">\(\tau\)</span> estimated from: <span id="eq-twfe"><span class="math display">\[
y_{st} = \gamma_s + \lambda_t + \tau w_{st} + \varepsilon_{st}
\tag{14.1}\]</span></span> where <span class="math inline">\(y_{st}\)</span> is the outcome variable, <span class="math inline">\(\gamma_s\)</span> and <span class="math inline">\(\lambda_t\)</span> are state (unit) and time fixed effects, <span class="math inline">\(w_{st}\)</span> is the binary treatment variable that takes the value of 1 if a state (unit) <span class="math inline">\(s\)</span> is treated at time <span class="math inline">\(t\)</span> and otherwise takes 0. We will work with a quite tractable example based on three units and 10 time periods, and will document how the approaches taken by <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> and by <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span> to understand the two-way FE estimator compare.</p>
<p>The results from <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> and those from <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span> are similar, however they take quite different paths to get there. Goodman-Bacon’s (like that laid out in <span class="citation" data-cites="AtheyImbens2018">Athey and Imbens (<a href="06_references.html#ref-AtheyImbens2018" role="doc-biblioref">2022</a>)</span>) is “mechanical” in that it is based on the underlying difference-in-differences comparisons between all groups. The result in <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span> is based on a potential outcomes frame-work, and counterfactuals under parallel trend assumptions. Thus to examine how these methods work requires somewhat different frameworks. In the case of <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span>, we should consider all possible DD comparisons, while in the case of <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span> we should consider the treatment effect for each unit and time period, which requires knowing the observed and counterfactual state. While the approaches the two papers take to understand the content of the estimator differ, they refer to the same estimator, so always recover the same parameter estimate. To examine this in a more applied way, we will look at a simulated example.</p>
<p>To do this, let’s consider a panel of 3 states/areas over the 10 years (<span class="math inline">\(t\)</span>) of 2000 to 2009. One of these units is entirely untreated (<span class="math inline">\(unit = 1\)</span> or group <span class="math inline">\(U\)</span>), one is treated at an early time period, 2003, (<span class="math inline">\(unit = 2\)</span> or group <span class="math inline">\(k\)</span>), and the other is treated at a later time period, 2006, (<span class="math inline">\(unit = 3\)</span> or group <span class="math inline">\(l\)</span>). We will construct a general structure for this data below:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Data <span class="op">=</span> pd.DataFrame({<span class="st">'unit'</span>: np.ceil(np.arange(<span class="dv">1</span>,<span class="dv">31</span>)<span class="op">/</span><span class="dv">10</span>), </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'year'</span>: np.tile(np.arange(<span class="dv">2000</span>, <span class="dv">2010</span>), <span class="dv">3</span>)})</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>unit</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>2004</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We will consider a simple-case where the actual data-generating process is known as: <span class="math display">\[y_{unit,t} = 2 + 0.2 \times (t - 2000) + 1 \times unit + \beta_1 \times post \times unit + \beta_2 \times post \times unit \times (t - treat).\]</span> Here <span class="math inline">\(unit\)</span> refers to the unit number listed above (1, 2 or 3), <span class="math inline">\(post\)</span> indicates that a unit is receiving treatment in the relevant time period <span class="math inline">\(t\)</span>, and <span class="math inline">\(treat\)</span> refers to the treatment period (2003 for unit 2, and 2006 for unit 3). Let’s generate treatment, time to treatment, and post-treatment variables in <code>R</code>:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'treat'</span>] <span class="op">=</span> np.where(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>, <span class="dv">2006</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                         np.where(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>, <span class="dv">2003</span>, <span class="dv">0</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'time'</span>] <span class="op">=</span> np.where(Data[<span class="st">'treat'</span>] <span class="op">==</span> <span class="dv">0</span>, <span class="dv">0</span>, Data[<span class="st">'year'</span>] <span class="op">-</span> Data[<span class="st">'treat'</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'post'</span>] <span class="op">=</span> np.where(((Data[<span class="st">'time'</span>] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (Data[<span class="st">'treat'</span>] <span class="op">!=</span> <span class="dv">0</span>)), <span class="dv">1</span>, <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This specification allows for each unit to have its own fixed effect, given that <span class="math inline">\(unit\)</span> is multiplied by 1, and allows for a general time trend increasing by 0.2 units each period across the whole sample. These parameters are not so important, as what we care about are the treatment effects themselves. The impact of treatment comes from the units <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. The first of these, <span class="math inline">\(\beta_1\)</span>, captures an immediate unit-specific jump when treatment is implemented which remains stable over time. The second of these, <span class="math inline">\(\beta_2\)</span>, implies a trend break occurring <em>only</em> for the treated units once treatment comes into place. We will consider 2 cases below. In the first case <span class="math inline">\(\beta_1 = 1\)</span> and <span class="math inline">\(\beta_2 = 0\)</span> (a simple case with a constant treatment effect per unit):</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'y1'</span>] <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> (Data[<span class="st">'year'</span>] <span class="op">-</span> <span class="dv">2000</span>) <span class="op">*</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Data[<span class="st">'post'</span>] <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">+</span> <span class="dv">0</span> <span class="op">*</span> Data[<span class="st">'post'</span>] <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">*</span> (Data[<span class="st">'time'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and in a second case <span class="math inline">\(\beta_1 = 1\)</span> and <span class="math inline">\(\beta_2 = 0.45\)</span>. This is a more complex case in which there are heterogeneous treatment effects over time:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'y2'</span>] <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> (Data[<span class="st">'year'</span>] <span class="op">-</span> <span class="dv">2000</span>) <span class="op">*</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> Data[<span class="st">'post'</span>] <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">+</span> <span class="fl">0.45</span> <span class="op">*</span> Data[<span class="st">'post'</span>] <span class="op">*</span> Data[<span class="st">'unit'</span>] <span class="op">*</span> (Data[<span class="st">'time'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These two cases are plotted next where the line with empty circles refers to group <span class="math inline">\(U\)</span>, the line with black filled circles refers to group <span class="math inline">\(k\)</span> and the line with squares refers to group <span class="math inline">\(l\)</span></p>
<div class="cell" data-execution_count="5">
<details>
<summary>Show the plot code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>[Fig1, ax] <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>]) </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>])</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>])</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>])</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>])</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>PanelA.set_yticks([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>])</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>PanelA.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>PanelA.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>PanelA.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>PanelA.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>PanelA.set_title(<span class="st">'(a) Simple Decomposition'</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>])</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>PanelB.set_yticks([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>])</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>PanelB.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>PanelB.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>PanelB.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>PanelB.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>PanelB.set_title(<span class="st">'(b) Decomposition with trends'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Text(0.5, 1.0, '(b) Decomposition with trends')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="03_04_Chapter4Python_files/figure-html/cell-6-output-4.png" width="589" height="455"></p>
</div>
</div>
<section id="the-two-way-fixed-effect-estimator" class="level3">
<h3 class="anchored" data-anchor-id="the-two-way-fixed-effect-estimator">The Two-way Fixed Effect Estimator</h3>
<p>First we will estimate the parameter by two-way fixed effects regression. This will provide us with the parameter estimate that both <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> and <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span> will construct in a piece-wise fashion. This is done relatively simply in <code>R</code>. We simply estimate <a href="#eq-twfe">Equation&nbsp;<span>14.1</span></a> by linear regression using <code>lm</code> as laid out below:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>case1 <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y1 ~ post + C(unit) + C(year)'</span>, data<span class="op">=</span>Data).fit()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The parameter estimates by two-way fixed effects regression for the case 1 is: "</span>, case1.params[<span class="st">"post"</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>case2 <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y2 ~ post + C(unit) + C(year)'</span>, data<span class="op">=</span>Data).fit()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The parameter estimates by two-way fixed effects regression for the case 2 is: "</span>, case2.params[<span class="st">"post"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The parameter estimates by two-way fixed effects regression for the case 1 is:  2.454545454545454
The parameter estimates by two-way fixed effects regression for the case 2 is:  3.804545454545457</code></pre>
</div>
</div>
<p>Here we see that the coefficient of interest is 2.454545. We can see that this is between the two unit-specific jumps that occur with treatment (2 and 3). We will see below why it takes this particular weighted average.</p>
</section>
<section id="goodmanbacon2018-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="goodmanbacon2018-decomposition"><span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> Decomposition</h3>
<p>Using the values simulated above, let’s see how the <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> decomposition allows us to understand estimated treatment effects. We will consider both:<br>
- (a) Simple Decomposition<br>
- (b) Decomposition with trends</p>
<p>The methodology <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> decomposition suggests that we should calculate all <span class="math inline">\(2 \times 2\)</span> combinations of states and time where post-treatment units are compared to “untreated” unit (laid out at more length in the boo). In this example, this provides four specific effects, which contribute to <span class="math inline">\(\widehat{\tau}\)</span> as a weighted mean. The specific effects desired are:</p>
<ul>
<li>A. <span class="math inline">\(\widehat{\beta}^{2\times2}_{kU}\)</span> from the comparison of the early treated unit with the untreated unit.<br>
</li>
<li>B. <span class="math inline">\(\widehat{\beta}^{2\times2}_{lU}\)</span>, from the comparison of the latter treated unit with the untreated unit.<br>
</li>
<li>C. <span class="math inline">\(\widehat{\beta}^{2\times2,k}_{kl}\)</span>, from the comparison of the early and latter treated units, when the early unit begin to be treated.<br>
</li>
<li>D. <span class="math inline">\(\widehat{\beta}^{2\times2,l}_{kl}\)</span>, from the comparison of the early and latter treated units, when the latter unit begin to be treated.</li>
</ul>
<p>These will then be weighted as laid out in <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> to provide the regression-based estimate.</p>
<section id="a-simple-decomposition" class="level4">
<h4 class="anchored" data-anchor-id="a-simple-decomposition">(a) Simple Decomposition</h4>
<p>In this case the <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> methodology estimate <span class="math inline">\(\widehat{\tau}\)</span> weighting the next four DD comparisons</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Show the plot code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>[Fig2, ax] <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelA</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>]) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>PanelA.set_yticks([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>])</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>PanelA.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>PanelA.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>PanelA.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>PanelA.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>PanelA.set_title(<span class="st">'A. Early Group v/s Untreated Group'</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelB</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>PanelB.set_yticks([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>])</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>PanelB.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>PanelB.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>PanelB.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>PanelB.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>PanelB.set_title(<span class="st">'B. Later Group v/s Untreated Group'</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelC</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>], </span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                      alpha <span class="op">=</span> <span class="fl">0.1</span>) </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>PanelC.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>PanelC.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>PanelC.set_yticks([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>])</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>PanelC.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>PanelC.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>PanelC.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>PanelC.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>PanelC.set_title(<span class="st">'C. Early Group v/s Later Group Before 2006'</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelD</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>], </span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>                      alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, </span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y1'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, </span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>PanelD.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>PanelD.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>PanelD.set_yticks([<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>])</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>PanelD.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>PanelD.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>PanelD.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>PanelD.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>PanelD.set_title(<span class="st">'D. Early Group v/s Later Group After 2003'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Text(0.5, 1.0, 'D. Early Group v/s Later Group After 2003')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="03_04_Chapter4Python_files/figure-html/cell-8-output-4.png" width="620" height="455"></p>
</div>
</div>
<p>As seen in the plots, in the simple decomposition these effects are constants of 3 and 2 for early and later treated units given that the “treatment effect” is simply <span class="math inline">\(1 \times unit\)</span> in each case.</p>
<section id="a.-early-group-vs-untreated-group" class="level5">
<h5 class="anchored" data-anchor-id="a.-early-group-vs-untreated-group">A. Early Group v/s Untreated Group</h5>
<p>In order to calculate the effects we start making the simple DD comparison of the untreated group <span class="math inline">\(U\)</span> (<span class="math inline">\(unit = 1\)</span>) with the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) getting <span class="math inline">\(\widehat{\beta}^{2 \times 2}_{kU}\)</span> as <span class="math display">\[\widehat{\beta}^{2 \times 2}_{kU} = \left( \overline{y}_k^{Post(k)} - \overline{y}_k^{Pre(k)} \right) - \left( \overline{y}_U^{Post(k)} - \overline{y}_U^{Pre(k)} \right)\]</span> Where <span class="math inline">\(\overline{y}_k^{Post(k)}\)</span> is the mean of the outcome variable for the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) posterior to treatment, from 2003, <span class="math inline">\(\overline{y}_k^{Pre(k)}\)</span> is the mean for of the outcome variable for the early treated group <span class="math inline">\(U\)</span> (<span class="math inline">\(unit = 3\)</span>) prior to treatment, (up until 2002), and <span class="math inline">\(\overline{y}_U^{Post(k)}, \overline{y}_U^{Post(k)}\)</span> are the analogous quantities for the untreated group <span class="math inline">\(U\)</span> (<span class="math inline">\(unit = 1\)</span>)</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>((Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'post'</span>] <span class="op">==</span> <span class="dv">1</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'post'</span>] <span class="op">==</span> <span class="dv">0</span>)][<span class="st">'y1'</span>].mean()) <span class="op">-</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>(Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2003</span>)][<span class="st">'y1'</span>].mean()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>2.9999999999999987</code></pre>
</div>
</div>
<p>This result also can be obtained from the linear regression with the canonical DD formula <span class="math display">\[y_{unit,t} = \alpha_0 + \alpha_1 \times Post(k) + \alpha_2 \times \mathbf{1}(unit = 3) + \beta_{kU}^{2\times2} \times Post(k) \times \mathbf{1}(unit = 3) + \varepsilon_i\]</span> Where <span class="math inline">\(Post(k)\)</span> indicates that the year is equal or greater than the year where the group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) received the treatment (2003) and <span class="math inline">\(\mathbf{1}(unit = 3)\)</span> indicates if the observation is from the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>)</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'post2003'</span>] <span class="op">=</span> np.where(Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sm.OLS.from_formula(<span class="st">'y1 ~ C(post2003) + C(unit) + C(post2003):C(unit)'</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">2</span>]).fit().summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>           <td>y1</td>        <th>  R-squared:         </th> <td>   0.980</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.977</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   266.1</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 08 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>7.35e-14</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:36:52</td>     <th>  Log-Likelihood:    </th> <td> -7.1761</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   22.35</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    16</td>      <th>  BIC:               </th> <td>   26.34</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                 <td></td>                    <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                       <td>    3.2000</td> <td>    0.224</td> <td>   14.311</td> <td> 0.000</td> <td>    2.726</td> <td>    3.674</td>
</tr>
<tr>
  <th>C(post2003)[T.1]</th>                <td>    1.0000</td> <td>    0.267</td> <td>    3.742</td> <td> 0.002</td> <td>    0.433</td> <td>    1.567</td>
</tr>
<tr>
  <th>C(unit)[T.3.0]</th>                  <td>    2.0000</td> <td>    0.316</td> <td>    6.325</td> <td> 0.000</td> <td>    1.330</td> <td>    2.670</td>
</tr>
<tr>
  <th>C(post2003)[T.1]:C(unit)[T.3.0]</th> <td>    3.0000</td> <td>    0.378</td> <td>    7.937</td> <td> 0.000</td> <td>    2.199</td> <td>    3.801</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 0.432</td> <th>  Durbin-Watson:     </th> <td>   1.067</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.806</td> <th>  Jarque-Bera (JB):  </th> <td>   0.533</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.000</td> <th>  Prob(JB):          </th> <td>   0.766</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.200</td> <th>  Cond. No.          </th> <td>    8.95</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p>A third way to obtain this is from the next linear regression <span class="math display">\[y_{unit,t} = \alpha_0 + \beta_{kU}^{2 \times 2} \times Post + \sum_{i = 2001}^{2009} \alpha_{i-2000} \times \mathbf{1}(year = i) + \alpha_{10} \times \mathbf{1}(unit = 3) + \varepsilon_i\]</span> Where in this case <span class="math inline">\(Post\)</span> indicates if the unit is treated (note for group <span class="math inline">\(U\)</span> this will be always 0), <span class="math inline">\(\mathbf{1}(year = i)\)</span> indicates if the observation is in period <span class="math inline">\(i \in \{2001, \ldots, 2009\}\)</span> and <span class="math inline">\(\mathbf{1}(unit = 3)\)</span> keep its meaning</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sm.OLS.from_formula(<span class="st">'y1 ~ post  + C(year) + C(unit)'</span>, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">2</span>]).fit().summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>           <td>y1</td>        <th>  R-squared:         </th> <td>   1.000</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   1.000</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>5.350e+29</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 08 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>3.24e-118</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:36:52</td>     <th>  Log-Likelihood:    </th> <td>  641.23</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>  -1258.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>     8</td>      <th>  BIC:               </th> <td>  -1247.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    11</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td>    3.0000</td> <td> 3.72e-15</td> <td> 8.06e+14</td> <td> 0.000</td> <td>    3.000</td> <td>    3.000</td>
</tr>
<tr>
  <th>C(year)[T.2001]</th> <td>    0.2000</td> <td> 4.56e-15</td> <td> 4.39e+13</td> <td> 0.000</td> <td>    0.200</td> <td>    0.200</td>
</tr>
<tr>
  <th>C(year)[T.2002]</th> <td>    0.4000</td> <td> 4.56e-15</td> <td> 8.78e+13</td> <td> 0.000</td> <td>    0.400</td> <td>    0.400</td>
</tr>
<tr>
  <th>C(year)[T.2003]</th> <td>    0.6000</td> <td> 5.07e-15</td> <td> 1.18e+14</td> <td> 0.000</td> <td>    0.600</td> <td>    0.600</td>
</tr>
<tr>
  <th>C(year)[T.2004]</th> <td>    0.8000</td> <td> 5.07e-15</td> <td> 1.58e+14</td> <td> 0.000</td> <td>    0.800</td> <td>    0.800</td>
</tr>
<tr>
  <th>C(year)[T.2005]</th> <td>    1.0000</td> <td> 5.07e-15</td> <td> 1.97e+14</td> <td> 0.000</td> <td>    1.000</td> <td>    1.000</td>
</tr>
<tr>
  <th>C(year)[T.2006]</th> <td>    1.2000</td> <td> 5.07e-15</td> <td> 2.37e+14</td> <td> 0.000</td> <td>    1.200</td> <td>    1.200</td>
</tr>
<tr>
  <th>C(year)[T.2007]</th> <td>    1.4000</td> <td> 5.07e-15</td> <td> 2.76e+14</td> <td> 0.000</td> <td>    1.400</td> <td>    1.400</td>
</tr>
<tr>
  <th>C(year)[T.2008]</th> <td>    1.6000</td> <td> 5.07e-15</td> <td> 3.16e+14</td> <td> 0.000</td> <td>    1.600</td> <td>    1.600</td>
</tr>
<tr>
  <th>C(year)[T.2009]</th> <td>    1.8000</td> <td> 5.07e-15</td> <td> 3.55e+14</td> <td> 0.000</td> <td>    1.800</td> <td>    1.800</td>
</tr>
<tr>
  <th>C(unit)[T.3.0]</th>  <td>    2.0000</td> <td> 3.72e-15</td> <td> 5.38e+14</td> <td> 0.000</td> <td>    2.000</td> <td>    2.000</td>
</tr>
<tr>
  <th>post</th>            <td>    3.0000</td> <td> 4.45e-15</td> <td> 6.75e+14</td> <td> 0.000</td> <td>    3.000</td> <td>    3.000</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 3.842</td> <th>  Durbin-Watson:     </th> <td>   0.304</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.146</td> <th>  Jarque-Bera (JB):  </th> <td>   2.411</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.846</td> <th>  Prob(JB):          </th> <td>   0.300</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.176</td> <th>  Cond. No.          </th> <td>    15.3</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p>Now we store this result for posterior use</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bku <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y1 ~ post  + C(year) + C(unit)'</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">2</span>]).fit().params[<span class="st">'post'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-later-group-vs-untreated-group" class="level5">
<h5 class="anchored" data-anchor-id="b.-later-group-vs-untreated-group">B. Later Group v/s Untreated Group</h5>
<p>The next DD comparison we calculate is that which compares the later treated group <span class="math inline">\(l\)</span> (<span class="math inline">\(unit = 2\)</span>) with the untreated group <span class="math inline">\(U\)</span> (<span class="math inline">\(unit = 1\)</span>), resulting in <span class="math inline">\(\widehat{\beta}^{2 \times 2}_{lU}\)</span>. As above, we can generate this DD estimate in a number of ways (most simply by double-differencing with means), and this will then be stored.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>blu <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y1 ~ post  + C(year) + C(unit)'</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">3</span>]).fit().params[<span class="st">'post'</span>]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(blu)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'post'</span>] <span class="op">==</span> <span class="dv">1</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'post'</span>] <span class="op">==</span> <span class="dv">0</span>)][<span class="st">'y1'</span>].mean()) <span class="op">-</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>(Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2006</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)][<span class="st">'y1'</span>].mean()))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>Data[<span class="st">'post2006'</span>] <span class="op">=</span> np.where(Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2006</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>sm.OLS.from_formula(<span class="st">'y1 ~ C(post2006) + C(unit) + C(post2006):C(unit)'</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">3</span>]).fit().summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.9999999999999993
2.000000000000001</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>           <td>y1</td>        <th>  R-squared:         </th> <td>   0.957</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.949</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   119.1</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 08 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>3.73e-11</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:36:52</td>     <th>  Log-Likelihood:    </th> <td> -4.2993</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   16.60</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    16</td>      <th>  BIC:               </th> <td>   20.58</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                 <td></td>                    <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                       <td>    3.5000</td> <td>    0.137</td> <td>   25.560</td> <td> 0.000</td> <td>    3.210</td> <td>    3.790</td>
</tr>
<tr>
  <th>C(post2006)[T.1]</th>                <td>    1.0000</td> <td>    0.217</td> <td>    4.619</td> <td> 0.000</td> <td>    0.541</td> <td>    1.459</td>
</tr>
<tr>
  <th>C(unit)[T.2.0]</th>                  <td>    1.0000</td> <td>    0.194</td> <td>    5.164</td> <td> 0.000</td> <td>    0.589</td> <td>    1.411</td>
</tr>
<tr>
  <th>C(post2006)[T.1]:C(unit)[T.2.0]</th> <td>    2.0000</td> <td>    0.306</td> <td>    6.532</td> <td> 0.000</td> <td>    1.351</td> <td>    2.649</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 1.576</td> <th>  Durbin-Watson:     </th> <td>   1.422</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.455</td> <th>  Jarque-Bera (JB):  </th> <td>   0.922</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.000</td> <th>  Prob(JB):          </th> <td>   0.631</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.948</td> <th>  Cond. No.          </th> <td>    6.41</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
</section>
<section id="c.-early-group-vs-later-group-before-2006" class="level5">
<h5 class="anchored" data-anchor-id="c.-early-group-vs-later-group-before-2006">C. Early Group v/s Later Group Before 2006</h5>
<p>Next we calculate the effects from the DD comparisons of early and later treated groups, up until the later treated group receives treatment (2006). This is: <span class="math display">\[\widehat{\beta}^{2 \times 2, k}_{kl} \equiv \left( \overline{y}^{Mid(k,l)}_{k} - \overline{y}^{Pre(k)}_{k} \right) - \left( \overline{y}^{Mid(k,l)}_{l} - \overline{y}^{Pre(k)}_{l} \right)\]</span> where <span class="math inline">\(\overline{y}^{Mid(k,l)}_{k}\)</span> is the mean of the outcome variable for the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) in the period between the treatment for the group <span class="math inline">\(k\)</span> and the group <span class="math inline">\(l\)</span> (<span class="math inline">\(unit = 2\)</span>), from 2003 to 2005, <span class="math inline">\(\overline{y}^{Pre(k)}_{k}\)</span> is the mean for of the outcome variable for the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) previous to treatment, until 2002, and <span class="math inline">\(\overline{y}^{Mid(k,l)}_{l}, \overline{y}^{Pre(k)}_{l}\)</span> are the analogous for the later treated group <span class="math inline">\(l\)</span> (<span class="math inline">\(unit = 2\)</span>)</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bklk <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y1 ~ post  + C(year) + C(unit)'</span>, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)]).fit().params[<span class="st">'post'</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bklk)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> ((Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>))][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2003</span>)][<span class="st">'y1'</span>].mean()) <span class="op">-</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>(Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> ((Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>))][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2003</span>)][<span class="st">'y1'</span>].mean()))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>sm.OLS.from_formula(<span class="st">'y1 ~ C(post2003) + C(unit) + C(post2003):C(unit)'</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)]).fit().summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.999999999999999
2.999999999999999</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\scipy\stats\_stats_py.py:1806: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=12
  warnings.warn("kurtosistest only valid for n&gt;=20 ... continuing "</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>           <td>y1</td>        <th>  R-squared:         </th> <td>   0.992</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.989</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   322.7</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 08 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>1.11e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:36:52</td>     <th>  Log-Likelihood:    </th> <td>  4.7188</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    12</td>      <th>  AIC:               </th> <td>  -1.438</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>     8</td>      <th>  BIC:               </th> <td>  0.5021</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                 <td></td>                    <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                       <td>    4.2000</td> <td>    0.115</td> <td>   36.373</td> <td> 0.000</td> <td>    3.934</td> <td>    4.466</td>
</tr>
<tr>
  <th>C(post2003)[T.1]</th>                <td>    0.6000</td> <td>    0.163</td> <td>    3.674</td> <td> 0.006</td> <td>    0.223</td> <td>    0.977</td>
</tr>
<tr>
  <th>C(unit)[T.3.0]</th>                  <td>    1.0000</td> <td>    0.163</td> <td>    6.124</td> <td> 0.000</td> <td>    0.623</td> <td>    1.377</td>
</tr>
<tr>
  <th>C(post2003)[T.1]:C(unit)[T.3.0]</th> <td>    3.0000</td> <td>    0.231</td> <td>   12.990</td> <td> 0.000</td> <td>    2.467</td> <td>    3.533</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 3.659</td> <th>  Durbin-Watson:     </th> <td>   2.500</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.160</td> <th>  Jarque-Bera (JB):  </th> <td>   1.125</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.000</td> <th>  Prob(JB):          </th> <td>   0.570</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.500</td> <th>  Cond. No.          </th> <td>    6.85</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
</section>
<section id="d.-early-group-vs-later-group-after-2003" class="level5">
<h5 class="anchored" data-anchor-id="d.-early-group-vs-later-group-after-2003">D. Early Group v/s Later Group After 2003</h5>
<p>The last DD comparison is for early and later treated groups, starting from 2006 <span class="math display">\[\widehat{\beta}^{2 \times 2, l}_{kl} \equiv \left( \overline{y}^{Post(l)}_{l} - \overline{y}^{Mid(k,l)}_{l} \right) - \left( \overline{y}^{Post(l)}_{k} - \overline{y}^{Mid(k,l)}_{k} \right)\]</span> Where <span class="math inline">\(\overline{y}^{Post(l)}_{l}\)</span> is the mean of the outcome variable for the later treated group <span class="math inline">\(l\)</span> (<span class="math inline">\(unit = 2\)</span>) in the period after this group received the treatment, from 2006, <span class="math inline">\(\overline{y}^{Mid(k,l)}_{l}\)</span> is the mean for of the outcome variable for the later treated group <span class="math inline">\(l\)</span> (<span class="math inline">\(unit = 2\)</span>) in the period between the treatment for the group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>) and the group <span class="math inline">\(l\)</span>, from 2003 to 2005, and <span class="math inline">\(\overline{y}^{Post(l)}_{k}, \overline{y}^{Mid(k,l)}_{k}\)</span> are the analogous quantities for the early treated group <span class="math inline">\(k\)</span> (<span class="math inline">\(unit = 3\)</span>). We can generate and save this quantity as we have previously:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bkll <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y1 ~ post  + C(year) + C(unit)'</span>, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)]).fit().params[<span class="st">'post'</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bkll)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2005</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> ((Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>))][<span class="st">'y1'</span>].mean()) <span class="op">-</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>(Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2005</span>)][<span class="st">'y1'</span>].mean() <span class="op">-</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a> Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> ((Data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">2003</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>))][<span class="st">'y1'</span>].mean()))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>sm.OLS.from_formula(<span class="st">'y1 ~ C(post2006) + C(unit) + C(post2006):C(unit)'</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                    data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)]).fit().summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.0000000000000018
2.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\scipy\stats\_stats_py.py:1806: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=14
  warnings.warn("kurtosistest only valid for n&gt;=20 ... continuing "</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>           <td>y1</td>        <th>  R-squared:         </th> <td>   0.987</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.983</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   249.5</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 08 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>1.07e-09</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:36:52</td>     <th>  Log-Likelihood:    </th> <td>  2.6670</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    14</td>      <th>  AIC:               </th> <td>   2.666</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    10</td>      <th>  BIC:               </th> <td>   5.222</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                 <td></td>                    <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                       <td>    4.8000</td> <td>    0.137</td> <td>   35.132</td> <td> 0.000</td> <td>    4.496</td> <td>    5.104</td>
</tr>
<tr>
  <th>C(post2006)[T.1]</th>                <td>    2.7000</td> <td>    0.181</td> <td>   14.939</td> <td> 0.000</td> <td>    2.297</td> <td>    3.103</td>
</tr>
<tr>
  <th>C(unit)[T.3.0]</th>                  <td>    4.0000</td> <td>    0.193</td> <td>   20.702</td> <td> 0.000</td> <td>    3.569</td> <td>    4.431</td>
</tr>
<tr>
  <th>C(post2006)[T.1]:C(unit)[T.3.0]</th> <td>   -2.0000</td> <td>    0.256</td> <td>   -7.825</td> <td> 0.000</td> <td>   -2.570</td> <td>   -1.430</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 1.936</td> <th>  Durbin-Watson:     </th> <td>   2.054</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.380</td> <th>  Jarque-Bera (JB):  </th> <td>   0.911</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.000</td> <th>  Prob(JB):          </th> <td>   0.634</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.750</td> <th>  Cond. No.          </th> <td>    7.39</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p>This comparison is the comparison which can potentially result in undesired results if treatment effects are dynamic over time because it views group 3 (the previously treated group) as a control. However, in this case, given that treatment effects are homogenous over time we do not have a major problem here, and we observe that <span class="math inline">\(\widehat{\beta}^{2 \times 2, l}_{kl}=2\)</span>.</p>
</section>
<section id="weights" class="level5">
<h5 class="anchored" data-anchor-id="weights">Weights</h5>
<p>We can now arrive to the OLS estimate of this two-way fixed effect model by generating the weighted mean of the previous estimates as: <span class="math display">\[\widehat{\tau} = W_{kU} \cdot \widehat{\beta}^{2\times 2}_{kU} + W_{lU} \cdot \widehat{\beta}^{2\times 2}_{lU} + W_{kl}^{k} \cdot \widehat{\beta}^{2\times 2,k}_{kl} + W_{kl}^{l} \cdot \widehat{\beta}^{2\times 2,l}_{kl}\]</span> Where each <span class="math inline">\(W\)</span> is the weight that the respective <span class="math inline">\(\beta\)</span> has in this weighted mean, specifically: <span class="math display">\[\begin{align*}
W_{kU} &amp; = \frac{(n_k + n_U)^2\widehat{V}^D_{kU}}{\widehat{V}^D} \quad &amp;  \quad W_{lU} &amp; = \frac{(n_l + n_U)^2\widehat{V}^D_{lU}}{\widehat{V}^D} \\
W_{kl}^k &amp; = \frac{[(n_k + n_l)(1 - \overline{D}_l)]^2\widehat{V}^{D,k}_{kl}}{\widehat{V}^D} \quad &amp;  \quad W_{kl}^l &amp; = \frac{[(n_k + n_l)(1 - \overline{D}_k)]^2\widehat{V}^{D,l}_{kl}}{\widehat{V}^D}
\end{align*}\]</span> Where <span class="math inline">\(n\)</span> refers to the sample share of the group</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nk <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>nl <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>nu <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\overline{D}\)</span> referes to the share of time the group is treated</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Dk <span class="op">=</span> Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>][<span class="st">'post'</span>].mean()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Dl <span class="op">=</span> Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>][<span class="st">'post'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and <span class="math inline">\(\widehat{V}\)</span> refers to how much treatment varies</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>VkU <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dk)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dk)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>VlU <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dl)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dl) </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>Vklk <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>((Dk<span class="op">-</span>Dl)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Dl))<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>Dk)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Dl))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Vkll <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dl<span class="op">/</span>Dk)<span class="op">*</span>((Dk<span class="op">-</span>Dl)<span class="op">/</span>(Dk))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>VD   <span class="op">=</span> (sm.OLS.from_formula(<span class="st">'post ~ C(unit) + C(year)'</span>, </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                           data<span class="op">=</span>Data).fit().resid<span class="op">**</span><span class="dv">2</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The weights are thus the following:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>wkU <span class="op">=</span> (((nk <span class="op">+</span> nu)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>VkU)<span class="op">/</span>VD</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wkU)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>wlU <span class="op">=</span> (((nl <span class="op">+</span> nu)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>VlU)<span class="op">/</span>VD</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wlU)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>wklk <span class="op">=</span> ((((nk <span class="op">+</span> nl)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dl))<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>Vklk)<span class="op">/</span>VD</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wklk)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>wkll <span class="op">=</span> ((((nk <span class="op">+</span> nl)<span class="op">*</span>Dk)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>Vkll)<span class="op">/</span>VD</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wkll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3181818181818182
0.3636363636363636
0.13636363636363635
0.1818181818181818</code></pre>
</div>
</div>
<p>With this in mind the <span class="math inline">\(\tau\)</span> estimate is</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tau <span class="op">=</span> wkU <span class="op">*</span> bku <span class="op">+</span> wlU <span class="op">*</span> blu <span class="op">+</span> wklk <span class="op">*</span> bklk <span class="op">+</span> wkll <span class="op">*</span> bkll</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.4545454545454537</code></pre>
</div>
</div>
<p>as observed in the two-way fixed effect estimate above.</p>
</section>
</section>
<section id="b-decomposition-with-trends" class="level4">
<h4 class="anchored" data-anchor-id="b-decomposition-with-trends">(b) Decomposition with trends</h4>
<p>In this case the <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> decomposition follows as above generating the treatment effect as follows:</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Show the plot code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>[Fig3, ax] <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelA</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>]) </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>PanelA <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>PanelA.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>PanelA.set_yticks([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>])</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>PanelA.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>PanelA.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>PanelA.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>PanelA.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>PanelA.set_title(<span class="st">'A. Early Group v/s Untreated Group'</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelB</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>PanelB <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>], x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, ax <span class="op">=</span> ax[<span class="dv">0</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>PanelB.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>PanelB.set_yticks([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>])</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>PanelB.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>PanelB.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>PanelB.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>PanelB.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>PanelB.set_title(<span class="st">'B. Later Group v/s Untreated Group'</span>)</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelC</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>], </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>                      alpha <span class="op">=</span> <span class="fl">0.1</span>) </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>PanelC <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)], </span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, </span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>PanelC.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>PanelC.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>PanelC.set_yticks([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>])</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>PanelC.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>PanelC.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>PanelC.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>PanelC.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>PanelC.set_title(<span class="st">'C. Early Group v/s Later Group Before 2006'</span>)</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a><span class="co">### PanelD</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>], </span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>                      alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">"$\circ$"</span>, </span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>], alpha <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.lineplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>                      x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">1</span>, ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>PanelD <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)], </span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>                         x <span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'y2'</span>, color<span class="op">=</span><span class="st">'black'</span>, marker<span class="op">=</span><span class="st">'s'</span>, </span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>                         ax <span class="op">=</span> ax[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>PanelD.axvline(<span class="dv">2002</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>PanelD.axvline(<span class="dv">2005</span>, color <span class="op">=</span> <span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>PanelD.set_yticks([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>])</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>PanelD.set_xticks([<span class="dv">2000</span>, <span class="dv">2002</span>, <span class="dv">2004</span>, <span class="dv">2006</span>, <span class="dv">2008</span>])</span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>PanelD.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>PanelD.set_ylabel(<span class="st">'Outcome Variable'</span>)</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>PanelD.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>PanelD.set_title(<span class="st">'D. Early Group v/s Later Group After 2003'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context('mode.use_inf_as_na', True):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
C:\Users\Usuario\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>Text(0.5, 1.0, 'D. Early Group v/s Later Group After 2003')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="03_04_Chapter4Python_files/figure-html/cell-21-output-4.png" width="620" height="455"></p>
</div>
</div>
<p>As seen in the plots, in the decomposition with trends these effects are no longer constants of 3 and 2 for early and later treated units given that the “treatment effect” is no longer simply <span class="math inline">\(1 \times unit\)</span> in each case.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2X2 DD Regressions</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>panelA <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y2 ~ post + C(year) + C(unit)'</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                         data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">2</span>]).fit()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>panelB <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y2 ~ post + C(year) + C(unit)'</span>, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                         data<span class="op">=</span>Data[Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">3</span>]).fit()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>panelC <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y2 ~ post + C(year) + C(unit)'</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                         data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">2006</span>)]).fit()</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>panelD <span class="op">=</span> sm.OLS.from_formula(<span class="st">'y2 ~ post + C(year) + C(unit)'</span>, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                         data<span class="op">=</span>Data[(Data[<span class="st">'unit'</span>] <span class="op">!=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (Data[<span class="st">'year'</span>] <span class="op">&gt;</span> <span class="dv">2002</span>)]).fit()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2 Betas</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>bkUk <span class="op">=</span> panelA.params[<span class="st">"post"</span>]</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>bkUl <span class="op">=</span> panelB.params[<span class="st">"post"</span>]</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>bklk <span class="op">=</span> panelC.params[<span class="st">"post"</span>]</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>bkll <span class="op">=</span> panelD.params[<span class="st">"post"</span>]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Share of time treated</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>Dk <span class="op">=</span> Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">3</span>][<span class="st">'post'</span>].mean()</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>Dl <span class="op">=</span> Data[Data[<span class="st">'unit'</span>] <span class="op">==</span> <span class="dv">2</span>][<span class="st">'post'</span>].mean()</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># How much treatment varies</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>VkU <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dk)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dk)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>VlU <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dl)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dl) </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>Vklk <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>((Dk<span class="op">-</span>Dl)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Dl))<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>Dk)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Dl))</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>Vkll <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>(Dl<span class="op">/</span>Dk)<span class="op">*</span>((Dk<span class="op">-</span>Dl)<span class="op">/</span>(Dk))</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>VD   <span class="op">=</span> (sm.OLS.from_formula(<span class="st">'post ~ C(unit) + C(year)'</span>, </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>                           data<span class="op">=</span>Data).fit().resid<span class="op">**</span><span class="dv">2</span>).mean()</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Share of sample</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>nk   <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>nl   <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>nu   <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Weights</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>wkUk <span class="op">=</span> (((nk <span class="op">+</span> nu)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>VkU)<span class="op">/</span>VD</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>wkUl <span class="op">=</span> (((nl <span class="op">+</span> nu)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>VlU)<span class="op">/</span>VD</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>wklk <span class="op">=</span> ((((nk <span class="op">+</span> nl)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Dl))<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>Vklk)<span class="op">/</span>VD</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>wkll <span class="op">=</span> ((((nk <span class="op">+</span> nl)<span class="op">*</span>Dk)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>Vkll)<span class="op">/</span>VD</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Tau</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>tau <span class="op">=</span> bkUk<span class="op">*</span>wkUk <span class="op">+</span> bkUl<span class="op">*</span>wkUl <span class="op">+</span> bklk<span class="op">*</span>wklk <span class="op">+</span> bkll<span class="op">*</span>wkll</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.804545454545457</code></pre>
</div>
</div>
<p>What is noteworthy here is the surprising behaviour flagged by <span class="citation" data-cites="GoodmanBacon2018">Goodman-Bacon (<a href="06_references.html#ref-GoodmanBacon2018" role="doc-biblioref">2021</a>)</span> for the final comparison based on the case where the earlier treated unit (unit 3) is used as a control for the later trated unit (unit 2). In this case, given that there <em>are</em> time-varying treatment effects, despite the fact that each unit-specific treatment effect is positive, we observe that the parameter <span class="math inline">\(\widehat{\beta}^{2 \times 2, l}_{kl}\)</span> is actually <em>negative</em>. In this particular example this negative value (-1.375) is not sufficient to turn the weighted treatment effect estimate negative, but if you play around with the size of the parameters <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> above, you will see that large enough differences in trends <em>can</em> result in such estimates! Here, as above, we see that when we aggregate unit-specific estimates as <code>tau</code>, the estimate (by definition) agrees with the estimate generated by two-way fixed effect models previously.</p>
</section>
</section>
<section id="dechaisemartindhaultfoeuille2019s-procedure" class="level3">
<h3 class="anchored" data-anchor-id="dechaisemartindhaultfoeuille2019s-procedure"><span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span>’s Procedure</h3>
<p>Now, we will show that the procedures described in <span class="citation" data-cites="deChaisemartinDhaultfoeuille2019">Chaisemartin and D’Haultfoeuille (<a href="06_references.html#ref-deChaisemartinDhaultfoeuille2019" role="doc-biblioref">2020</a>)</span>, despite arriving to the estimator in a different way, also let us understand how the regression weights the two-way fixed effect estimator. In this case, rather than considering each treatment-control comparison pair, the authors note that the two-way fixed estimator can be conceived as a weighted sum of each single group by time period in any post-treatment group.</p>
<p>The authors define <span class="math inline">\(\widehat{\beta}_{fe}\)</span> as the coefficient estimated in the following (standard) two-way fixed effects regression: <span class="math display">\[y_{i,s,t} = \beta_0 + \beta_{fe} D_{s,t} + \mu_s + \lambda_t + \varepsilon_{s,t}\]</span> Where <span class="math inline">\(D_{s,t}\)</span> is the mean over <span class="math inline">\(i\)</span> of a binary indicator variable that takes value of 1 if the unit <span class="math inline">\(i\)</span> in state <span class="math inline">\(s\)</span> is treated at period <span class="math inline">\(t\)</span> and 0 otherwise, in our case as we have one observartion per state <span class="math inline">\(D_{s,t} = post_{s,t}\)</span>, meanwhile <span class="math inline">\(\mu_s\)</span> and <span class="math inline">\(\lambda_t\)</span> are state and time fixed effects. This is, of course, precisely the same model as we have estimated in <a href="#eq-twfe">Equation&nbsp;<span>14.1</span></a>, implying that <span class="math inline">\(\beta_{fe}=2.4545\)</span> in cases without post-treatment trends (<code>y1</code>), or <span class="math inline">\(\beta_{fe}=3.8045\)</span> in cases with post-treatment dynamics (<code>y2</code>).</p>
</section>
</section>
<section id="synthetic-control-exercise" class="level2">
<h2 class="anchored" data-anchor-id="synthetic-control-exercise">Synthetic Control Exercise</h2>
<p>The synthetic control method seeks to construct a “synthetic control” for a treated unit (in this case, California) using a weighted combination of control units (other states). The aim is for this synthetic control to closely resemble the treated unit in the pre-treatment period based on predictor variables.</p>
<ul>
<li>Use the ‘synth’ command to construct the synthetic control for California</li>
<li>Predictor variables: cigsale from specific years, beer, lnincome, retprice, age15to24</li>
<li>Treated unit: California (state==3)</li>
<li>Treatment period: 1989</li>
<li>Periods used to construct the synthetic control: 1980-1988</li>
</ul>
<p>Once the synthetic control is constructed, we can compare the trends of the treated unit and the synthetic control in the post-treatment period. Any divergence in trends is interpreted as the treatment effect. In this case, we are assessing the impact of a hypothetical policy implemented in California in 1989 on cigarette sales.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import pandas as pd</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># from SyntheticControlMethods import Synth</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load the Dataset</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_stata("Datasets/smoking.dta")</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Prepare the Data</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df = df.sort_values(by=['state', 'year'])</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the treatment period and the unit receiving the treatment</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># treatment_period = 1989</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># treated_unit = 'California'</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Predictor variables - Ensure these are present in your dataset</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors = ['cigsale', 'beer', 'lnincome', 'retprice', 'age15to24']</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit the Synthetic Control Model</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># sc = Synth(df, "cigsale", "state", "year", treatment_period, treated_unit, pen=0)</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # Visualize the Synthetic Control</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># sc.plot(["original", "pointwise", "cumulative"], treated_label="California", </span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co">#         synth_label="Synthetic California", treatment_label="Tobacco Policy Change")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Results:</strong></p>
<ul>
<li>The synthetic control for California is constructed using a combination of other states. Specifically, weights are assigned to states like Colorado, Connecticut, Montana, Nevada, New Mexico, and Utah.</li>
<li>The RMSPE (Root Mean Squared Prediction Error) is a measure of how well the synthetic control approximates California in the pre-treatment period. A lower RMSPE indicates a better fit. In this case, the RMSPE is 1.756235, suggesting a reasonably good fit.</li>
<li>The “Predictor Balance” table shows how California and the synthetic control compare in terms of the predictor variables. The figures show that there is a good balance between the treated unit and the synthetic control on these variables.</li>
<li>The graph displays per capita cigarette sales in California and the synthetic control over time. The divergence between the two lines post-1989 represents the estimated effect of the policy</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-AtheyImbens2018" class="csl-entry" role="doc-biblioentry">
Athey, Susan, and Guido W. Imbens. 2022. <span>“<span class="nocase">Design-based analysis in Difference-In-Differences settings with staggered adoption</span>.”</span> <em>Journal of Econometrics</em> 226 (1): 62–79. https://doi.org/<a href="https://doi.org/10.1016/j.jeconom.2020.10.012">https://doi.org/10.1016/j.jeconom.2020.10.012</a>.
</div>
<div id="ref-deChaisemartinDhaultfoeuille2019" class="csl-entry" role="doc-biblioentry">
Chaisemartin, Clément de, and Xavier D’Haultfoeuille. 2020. <span>“Two-Way Fixed Effects Estimators with Heterogeneous Treatment Effects.”</span> <em>American Economic Review</em> 110 (9): 2964–96. <a href="https://doi.org/10.1257/aer.20181169">https://doi.org/10.1257/aer.20181169</a>.
</div>
<div id="ref-GoodmanBacon2018" class="csl-entry" role="doc-biblioentry">
Goodman-Bacon, Andrew. 2021. <span>“Difference-in-Differences with Variation in Treatment Timing.”</span> <em>Journal of Econometrics</em> 225 (2): 254–77. https://doi.org/<a href="https://doi.org/10.1016/j.jeconom.2021.03.014">https://doi.org/10.1016/j.jeconom.2021.03.014</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_03_Chapter3Python.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 3</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_references.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">References</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>